<table class="parent-table">
    <tbody>
        <tr>
            <td>
                <table>
                    <tbody>
                        <tr>
                            <td colspan="5" class="text-center learning-result-table-header">
                                Thông tin kết quả học tập
                            </td>
                        </tr>
                        <tr class="tr-lietkeResult">
                            <td class="td-lietkeResult">
                                <table>
                                    <tbody>
                                        <tr class="text-center">
                                            <td style="width: 30%;" class="text-end">Năm học</td>
                                            <td>
                                                <select class="select-lietke" name="" id="namhoc" [(ngModel)]="namhoc">
                                                    <option value="2020">2020-2021</option>
                                                    <option value="2021">2021-2022</option>
                                                    <option value="2022">2022-2023</option>
                                                    <option value="2023">2023-2024</option>
                                                    <option value="0">Tất cả</option>
                                                </select>
                                            </td>
                                            <td class="text-start">Học kỳ</td>
                                            <td class="text-start">
                                                <select class="select-lietke" name="" id="hocky" [(ngModel)]="hocky">
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="0">Tất cả</option>
                                                </select>
                                            </td>
                                            <td style="width: 30%;" class="text-start">
                                                <button class="btn-lietke" id="btnLietke" (click)="onclickLietke()">
                                                    Liệt kê
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!-- Bảng thành phần -->
                <div *ngIf="isLietKe==true">
                    <ng-container *ngIf="dataSelected.length > 0; else NoData">
                        <table *ngFor="let data of dataSelected" class="tables-Result">
                            <tbody>
                                <tr>
                                    <td colspan="5" class="text-center learning-result-table-header">
                                       {{data.ten_hoc_ky}}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                  <th scope="col">STT</th>
                                                  <th style="width: 11%;" scope="col">Mã môn học</th>
                                                  <th scope="col">Tên môn học</th>
                                                  <th scope="col">Số TC</th>
                                                  <th scope="col">Điểm chữ</th>
                                                  <th scope="col">Điểm số</th>
                                                  <th scope="col">Điểm thành phần</th>
                                                  <th scope="col">Tích lũy</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                                <ng-container *ngIf="data.ds_diem_mon_hoc && data.ds_diem_mon_hoc.length > 0">
                                                    <tr *ngFor="let value of data.ds_diem_mon_hoc; index as i">
                                                      <td class="text-center">{{i+1}}</td>
                                                      <td>{{value['ma_mon']}}</td>
                                                      <td>{{value['ten_mon']}}</td>
                                                      <td class="text-center">{{value['so_tin_chi']}}</td>
                                                      <td class="text-center">{{value['diem_tk_chu']}}</td>
                                                      <td class="text-center">{{value['diem_tk_so']}}</td>
                                                      <td mat-button (click)="openDialog(value)" class="text-center {{value['diem_tk_so'] ? 'xem-diem' : ''}}">{{value['diem_tk_so'] ? 'xem' : ''}}</td>
                                                      <td class="text-center" style="color: red; font-size: 20px;">{{value['diem_tk_so'] >= 1 ? '*' : ''}}</td>
                                                    </tr>
                                                </ng-container>
                                              </tbody>
                                        </table>
                                        <table class="table table-light table-tk">
                                            <tbody>
                                                <tr>
                                                    <td>Tổng số tính chỉ đăng ký</td>
                                                    <ng-container *ngFor="let item of total_TC_Dky_">
                                                        <td *ngIf="item.hocky === data.hoc_ky">
                                                            {{item['total']}}
                                                        </td>
                                                    </ng-container>
                                                    <td>Điểm trung bình học kỳ</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>Tổng số tín chỉ tích lũy học kỳ</td>
                                                    <td></td>
                                                    <td>Điểm trung bình tích lũy</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>Tổng số tín chỉ tích lũy</td>
                                                    <td></td>
                                                    <td>Điểm rèn luyện</td>
                                                    <td>80</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </ng-container>
                    <ng-template #NoData>
                        <table>
                            <tbody>
                                <tr>
                                    <td class="p-3 text-center">
                                        Không có dữ liệu để hiển thị
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </ng-template>
                    <div class="my-2 note">
                        <table>
                            <tbody>
                                <tr>
                                    <td>
                                        <span>Nếu có bất kỳ sai sót hoặc thắc gì về điểm số xin vui lòng liên hệ email: <b style="color: red;">nhtuong2001@gmail.com</b> để được giải đáp</span><br>
                                        <span>Hệ thống sẽ xử lý điểm sau khi có đầy đủ điểm các môn học đã đăng ký trong học kỳ. Sinh viên có thắc mắc về điểm học phần vui lòng liên hệ giảng viên giảng dạy để được giải đáp</span><br>
                                        <span style="color: red;">Các học phần giáo dục thể chất sẽ không được tính vào điểm trung bình tích lũy</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div *ngIf="isLietKe == false">
                    <ng-container *ngIf="dataResult[0]">
                        <table class="tables-Result">
                            <tbody>
                                <tr>
                                    <td colspan="5" class="text-center learning-result-table-header">
                                        {{dataResult[0].ten_hoc_ky}}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <table class="table table-striped table-hover table-bordered">
                                            <thead>
                                                <tr>
                                                    <th scope="col">STT</th>
                                                    <th style="width: 11%;" scope="col">Mã môn học</th>
                                                    <th scope="col">Tên môn học</th>
                                                    <th scope="col">Số TC</th>
                                                    <th scope="col">Điểm chữ</th>
                                                    <th scope="col">Điểm số</th>
                                                    <th style="width: 15%;" scope="col">Điểm thành phần</th>
                                                    <th scope="col">Tích lũy</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                                <ng-container *ngIf="dataResult[0].ds_diem_mon_hoc">
                                                    <tr *ngFor="let value of dataResult[0].ds_diem_mon_hoc; index as i">
                                                        <td class="text-center">{{i+1}}</td>
                                                        <td>{{value['ma_mon']}}</td>
                                                        <td>{{value['ten_mon']}}</td>
                                                        <td class="text-center">{{value['so_tin_chi']}}</td>
                                                        <td class="text-center">{{value['diem_tk_chu']}}</td>
                                                        <td class="text-center">{{value['diem_tk_so']}}</td>
                                                        <td mat-button (click)="openDialog(value)" class="text-center {{value['diem_tk_so'] ? 'xem-diem' : ''}}">{{value['diem_tk_so'] ? 'xem' : ''}}</td>
                                                        <td style="color: red; font-size: 20px; text-align: center;">{{value['diem_tk_so'] >= 1 ? '*' : ''}}</td>
                                                    </tr>
                                                </ng-container>
                                              </tbody>
                                        </table>
                                        <table class="table table-light table-tk">
                                            <tbody>
                                                <tr>
                                                    <td>Tổng số tín chỉ đăng ký</td>
                                                    <td>{{total_TC_Dky}}</td>
                                                    <td>Điểm trung bình học kỳ</td>
                                                    <td>{{dataResult[0].dtb_hk_he4}}</td>
                                                </tr>
                                                <tr>
                                                    <td>Tổng số tín chỉ tích lũy học kỳ</td>
                                                    <td>{{dataResult[0].so_tin_chi_dat_hk}}</td>
                                                    <td>Điểm trung bình tích lũy</td>
                                                    <td>{{dataResult[0].dtb_tich_luy_he_4}}</td>
                                                </tr>
                                                <tr>
                                                    <td>Tổng số tín chỉ tích lũy</td>
                                                    <td>
                                                        {{dataResult[0].so_tin_chi_dat_tich_luy}}
                                                    </td>
                                                    <td>Điểm rèn luyện</td>
                                                    <td>80</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </ng-container>
                </div>
                <ng-container *ngIf="dataResult.length === 0">
                    <table>
                        <tbody>
                            <tr>
                                <td class="p-3 text-center">
                                    Không có dữ liệu để hiển thị
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </ng-container>
                <div class="my-2 note">
                    <table>
                        <tbody>
                            <tr>
                                <td>
                                    <span>Nếu có bất kỳ sai sót hoặc thắc gì về điểm số xin vui lòng liên hệ email: <b style="color: red;">nhtuong2001@gmail.com</b> để được giải đáp</span><br>
                                    <span>Hệ thống sẽ xử lý điểm sau khi có đầy đủ điểm các môn học đã đăng ký trong học kỳ. Sinh viên có thắc mắc về điểm học phần vui lòng liên hệ giảng viên giảng dạy để được giải đáp</span><br>
                                    <span style="color: red;">Các học phần giáo dục thể chất sẽ không được tính vào điểm trung bình tích lũy</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="text-center">
                    <button routerLink="/home" class="btn-back">Trở lại</button>
                </div>
            </td>
        </tr>
    </tbody>
</table>